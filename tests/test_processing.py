from person_statistics.models import UserListSchema
from person_statistics.processing import *
test_small_json_blob = """
{"results":[{"gender":"male","name":{"title":"Mr","first":"Jacob","last":"Poulsen"},"location":{"street":{"number":3137,"name":"Venusvej"},"city":"Odense Sv","state":"Danmark","country":"Denmark","postcode":49317,"coordinates":{"latitude":"-33.7210","longitude":"-44.8240"},"timezone":{"offset":"+3:00","description":"Baghdad, Riyadh, Moscow, St. Petersburg"}},"email":"jacob.poulsen@example.com","login":{"uuid":"5d85e916-a685-4e8a-af86-1f1883378b40","username":"orangekoala199","password":"ventura","salt":"PAFv3FOP","md5":"789ae2d9f61e80e43fd46b004d9178e0","sha1":"7b9bce3206179b2b6102f6be88cd8bfc5be5bb97","sha256":"c308db872c8492cb4f3ac769f06dda18deca1f097afa4ea83beb1e3341dc21da"},"dob":{"date":"1997-06-01T21:42:55.244Z","age":25},"registered":{"date":"2004-05-12T03:42:50.057Z","age":18},"phone":"52245630","cell":"04137724","id":{"name":"CPR","value":"010697-3802"},"picture":{"large":"https://randomuser.me/api/portraits/men/55.jpg","medium":"https://randomuser.me/api/portraits/med/men/55.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/men/55.jpg"},"nat":"DK"},{"gender":"male","name":{"title":"Mr","first":"Christian","last":"Thomsen"},"location":{"street":{"number":8226,"name":"Solsikkevej"},"city":"Kongens  Lyngby","state":"Hovedstaden","country":"Denmark","postcode":61838,"coordinates":{"latitude":"-84.2609","longitude":"-8.4030"},"timezone":{"offset":"-5:00","description":"Eastern Time (US & Canada), Bogota, Lima"}},"email":"christian.thomsen@example.com","login":{"uuid":"25bb465e-0454-43f3-9c63-989e0cf0ba3a","username":"brownmouse853","password":"oxford","salt":"GJ4cV9cS","md5":"8ea2414d04171febc55261ff1555b0bd","sha1":"3c09643a1122d0553093ba9b1e36418d36c5b6f4","sha256":"29f8dfc8c94d1672a8a988d485823b396a627dd33ad009a604a347f9f6084a28"},"dob":{"date":"1970-12-31T13:27:08.217Z","age":52},"registered":{"date":"2018-06-25T03:23:52.008Z","age":4},"phone":"63771039","cell":"39184852","id":{"name":"CPR","value":"311270-0605"},"picture":{"large":"https://randomuser.me/api/portraits/men/19.jpg","medium":"https://randomuser.me/api/portraits/med/men/19.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/men/19.jpg"},"nat":"DK"},{"gender":"female","name":{"title":"Mrs","first":"آدرینا","last":"موسوی"},"location":{"street":{"number":3272,"name":"جمهوری اسلامی"},"city":"رشت","state":"سمنان","country":"Iran","postcode":59374,"coordinates":{"latitude":"60.6490","longitude":"-4.6600"},"timezone":{"offset":"-8:00","description":"Pacific Time (US & Canada)"}},"email":"adryn.mwswy@example.com","login":{"uuid":"e396cb10-6f6e-43d7-9841-908ba0a92536","username":"whitecat109","password":"corleone","salt":"xlnU7sMX","md5":"389049da891c8cab21f9cb3111c7f7d9","sha1":"e12af4a31fda4d14a3f14fd4db18aec6d10c2f8e","sha256":"5fd19eea73e0907a836daeadea37a4e0215773c691d7e4ad1054113882a3ce50"},"dob":{"date":"1979-07-09T15:33:53.459Z","age":43},"registered":{"date":"2019-03-22T06:22:25.589Z","age":3},"phone":"040-98393543","cell":"0941-425-1027","id":{"name":"","value":null},"picture":{"large":"https://randomuser.me/api/portraits/women/36.jpg","medium":"https://randomuser.me/api/portraits/med/women/36.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/women/36.jpg"},"nat":"IR"}],"info":{"seed":"80f06020794781f3","results":3,"page":1,"version":"1.3"}}
"""

test_large_json_blob = """
{"results":[{"gender":"male","name":{"title":"Mr","first":"Jonathan","last":"Alvarez"},"location":{"street":{"number":2078,"name":"Grove Road"},"city":"Preston","state":"Greater Manchester","country":"United Kingdom","postcode":"D7 2YW","coordinates":{"latitude":"5.7091","longitude":"-47.6143"},"timezone":{"offset":"-10:00","description":"Hawaii"}},"email":"jonathan.alvarez@example.com","login":{"uuid":"80133b63-6737-4e09-915f-e7c1ba122e2f","username":"goldenwolf923","password":"abcd1234","salt":"xDmE4aLJ","md5":"ed0ada1b321b195e4ec5e3ce6fe55560","sha1":"019b97914f9810079d9dc2603b3212d9bce88c21","sha256":"c326f6b83ddd78dc3f2b5ee20ab5583096e7132fead03e8145263fdd9552a791"},"dob":{"date":"1970-01-29T09:49:11.935Z","age":52},"registered":{"date":"2016-05-23T14:51:18.554Z","age":6},"phone":"027 7368 2636","cell":"0765-953-658","id":{"name":"NINO","value":"JT 46 22 67 N"},"picture":{"large":"https://randomuser.me/api/portraits/men/12.jpg","medium":"https://randomuser.me/api/portraits/med/men/12.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/men/12.jpg"},"nat":"GB"},{"gender":"female","name":{"title":"Mrs","first":"Ege","last":"Önür"},"location":{"street":{"number":454,"name":"Kushimoto Sk"},"city":"Konya","state":"Adana","country":"Turkey","postcode":86387,"coordinates":{"latitude":"-68.5818","longitude":"168.4241"},"timezone":{"offset":"+6:00","description":"Almaty, Dhaka, Colombo"}},"email":"ege.onur@example.com","login":{"uuid":"e96d028c-15ab-4c4e-88a2-5db071223855","username":"blackkoala387","password":"norway","salt":"FbMdaDoB","md5":"eb20e57a460704ec52998ac5c927f545","sha1":"fd30a675f4dc323d389b18cc2afb2b91a8bba323","sha256":"a602734feb7b797305b22937df7444ace6d164b90015b111eaa70473d2956748"},"dob":{"date":"1996-12-14T19:59:36.409Z","age":26},"registered":{"date":"2015-04-06T23:49:39.646Z","age":7},"phone":"(359)-054-6498","cell":"(151)-808-1660","id":{"name":"","value":null},"picture":{"large":"https://randomuser.me/api/portraits/women/47.jpg","medium":"https://randomuser.me/api/portraits/med/women/47.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/women/47.jpg"},"nat":"TR"},{"gender":"female","name":{"title":"Miss","first":"Rosi","last":"Blessing"},"location":{"street":{"number":9181,"name":"Tulpenweg"},"city":"Neuburg-Schrobenhausen","state":"Berlin","country":"Germany","postcode":73303,"coordinates":{"latitude":"-15.5194","longitude":"121.8464"},"timezone":{"offset":"-5:00","description":"Eastern Time (US & Canada), Bogota, Lima"}},"email":"rosi.blessing@example.com","login":{"uuid":"4053eb0c-9b1f-4bac-a22f-7662b4b1d702","username":"sadmeercat547","password":"fishes","salt":"kJVxPznz","md5":"94e2d3fd223f2006188a2131ac0e620b","sha1":"ae0effb739e79b6f7d2842d4cb651cc78987e2ea","sha256":"de405d19f5acfd1d241877de3e3012114a936176ec699a86e62b65bdcf0ac9f8"},"dob":{"date":"1966-04-28T04:14:28.909Z","age":56},"registered":{"date":"2006-05-26T03:49:22.599Z","age":16},"phone":"0485-4675225","cell":"0170-3661775","id":{"name":"","value":null},"picture":{"large":"https://randomuser.me/api/portraits/women/12.jpg","medium":"https://randomuser.me/api/portraits/med/women/12.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/women/12.jpg"},"nat":"DE"},{"gender":"female","name":{"title":"Ms","first":"Rishma","last":"Kruitbosch"},"location":{"street":{"number":6253,"name":"Donkerewegje"},"city":"Ijhorst","state":"Zuid-Holland","country":"Netherlands","postcode":96678,"coordinates":{"latitude":"77.2522","longitude":"-43.7904"},"timezone":{"offset":"+9:00","description":"Tokyo, Seoul, Osaka, Sapporo, Yakutsk"}},"email":"rishma.kruitbosch@example.com","login":{"uuid":"6f936c77-1d7d-44a9-a475-1e77fcb5ad3a","username":"goldenwolf912","password":"playoffs","salt":"11uMbsVk","md5":"87cd0d5bf87f3e2585d699794ad7f4d0","sha1":"bae1eae8a9300bbf11a7b555d23b19e5a0a6331f","sha256":"e94ce9437e951243b7f85a9f141a97a6a0fcc53cb6aff60e0c077c0ca67897d9"},"dob":{"date":"1967-08-08T14:01:06.884Z","age":55},"registered":{"date":"2008-10-31T18:34:47.445Z","age":14},"phone":"(789)-472-5429","cell":"(197)-226-8494","id":{"name":"BSN","value":"22445873"},"picture":{"large":"https://randomuser.me/api/portraits/women/11.jpg","medium":"https://randomuser.me/api/portraits/med/women/11.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/women/11.jpg"},"nat":"NL"},{"gender":"female","name":{"title":"Ms","first":"Claudia","last":"Garcia"},"location":{"street":{"number":1779,"name":"Calle de Ferraz"},"city":"Palma de Mallorca","state":"Canarias","country":"Spain","postcode":56593,"coordinates":{"latitude":"-27.4975","longitude":"66.8602"},"timezone":{"offset":"-2:00","description":"Mid-Atlantic"}},"email":"claudia.garcia@example.com","login":{"uuid":"f99f8598-d2b4-4ed8-97c7-43e2eabab67a","username":"heavybird884","password":"baron","salt":"9UwT364Z","md5":"ce015374ba096797d06907bd0cc2aeeb","sha1":"0c9c648f590738afc5f7323a27131e1f16fdf851","sha256":"b7119f1437d25cde87f04a5488268fbbbaa872371d89c20d0a017b3a6a3dcd7c"},"dob":{"date":"1984-03-31T20:56:40.800Z","age":38},"registered":{"date":"2007-03-06T09:44:19.087Z","age":15},"phone":"960-230-507","cell":"637-572-314","id":{"name":"DNI","value":"08344516-H"},"picture":{"large":"https://randomuser.me/api/portraits/women/0.jpg","medium":"https://randomuser.me/api/portraits/med/women/0.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/women/0.jpg"},"nat":"ES"},{"gender":"male","name":{"title":"Mr","first":"Oscar","last":"Kristensen"},"location":{"street":{"number":8697,"name":"Åbrinken"},"city":"Ryslinge","state":"Sjælland","country":"Denmark","postcode":79922,"coordinates":{"latitude":"78.8909","longitude":"-36.2994"},"timezone":{"offset":"-1:00","description":"Azores, Cape Verde Islands"}},"email":"oscar.kristensen@example.com","login":{"uuid":"17dc5f79-6aa5-4825-87b4-4ab8ec4eac03","username":"crazyzebra441","password":"lighting","salt":"INtnmEnW","md5":"655c671521b7bdef4bcea68f589e0cc6","sha1":"746f210ad8d5ec1fb781d4a2fa3a146f8947de20","sha256":"a5e9f57b8d29301d2b11c6b3c376e71ca48f3fded78e73c8b5dbf7b093539323"},"dob":{"date":"1971-06-21T10:18:46.146Z","age":51},"registered":{"date":"2019-08-16T15:48:19.126Z","age":3},"phone":"15112982","cell":"11217342","id":{"name":"CPR","value":"210671-3849"},"picture":{"large":"https://randomuser.me/api/portraits/men/36.jpg","medium":"https://randomuser.me/api/portraits/med/men/36.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/men/36.jpg"},"nat":"DK"},{"gender":"male","name":{"title":"Mr","first":"Fred","last":"Collins"},"location":{"street":{"number":9634,"name":"Hillcrest Rd"},"city":"Philadelphia","state":"Washington","country":"United States","postcode":72892,"coordinates":{"latitude":"3.0278","longitude":"-179.6536"},"timezone":{"offset":"+7:00","description":"Bangkok, Hanoi, Jakarta"}},"email":"fred.collins@example.com","login":{"uuid":"d8091073-7a26-45fb-b58e-087a7ec293d0","username":"heavysnake989","password":"spurs1","salt":"zPrRtxGn","md5":"3205d79ab676636a818092945d066004","sha1":"8d2d3c7bc1c7f3228ad447dd8d74b8305e31167c","sha256":"28a0777a048f78fd39cd0f835be8373293f1cbdea57e2477a73c2589e66bc201"},"dob":{"date":"1993-01-17T11:45:28.446Z","age":29},"registered":{"date":"2015-12-09T16:09:31.708Z","age":7},"phone":"(536)-114-6059","cell":"(470)-101-4157","id":{"name":"SSN","value":"297-36-1694"},"picture":{"large":"https://randomuser.me/api/portraits/men/27.jpg","medium":"https://randomuser.me/api/portraits/med/men/27.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/men/27.jpg"},"nat":"US"},{"gender":"male","name":{"title":"Mr","first":"Alexander","last":"Cortes"},"location":{"street":{"number":6978,"name":"Avenida de América"},"city":"Valladolid","state":"Andalucía","country":"Spain","postcode":45841,"coordinates":{"latitude":"62.2950","longitude":"-125.1525"},"timezone":{"offset":"+6:00","description":"Almaty, Dhaka, Colombo"}},"email":"alexander.cortes@example.com","login":{"uuid":"ba14fd01-4ee9-42b2-9c5a-6365b976326e","username":"whiterabbit275","password":"roadkill","salt":"ygbss83e","md5":"dc88ca1429b32ee1c689c1c06a3c6975","sha1":"dee9ee22f7ae47e4da7a84245ef87e6eae06c803","sha256":"9d42bc35503ed315238d086aa08a2ca07665844bf3174a6e9e63c252bcdeb471"},"dob":{"date":"1962-02-25T13:45:10.287Z","age":60},"registered":{"date":"2011-09-23T21:51:34.098Z","age":11},"phone":"963-562-544","cell":"646-764-631","id":{"name":"DNI","value":"20074924-J"},"picture":{"large":"https://randomuser.me/api/portraits/men/25.jpg","medium":"https://randomuser.me/api/portraits/med/men/25.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/men/25.jpg"},"nat":"ES"},{"gender":"female","name":{"title":"Mrs","first":"Beatrice","last":"Höpfner"},"location":{"street":{"number":2834,"name":"Kirchstraße"},"city":"Lauter-Bernsbach","state":"Thüringen","country":"Germany","postcode":18037,"coordinates":{"latitude":"11.4784","longitude":"-20.1428"},"timezone":{"offset":"-2:00","description":"Mid-Atlantic"}},"email":"beatrice.hopfner@example.com","login":{"uuid":"ac934806-aa2c-4b8c-ac6d-ea76ffdd5904","username":"angryswan290","password":"rocker","salt":"Ps4LT1pL","md5":"0ba3045b2bd1424369680622e5ab5f90","sha1":"04c8ae11951e7c9b30f4a8105ece8441ffbe8ceb","sha256":"75338c854c9ddd4248d9ba3356ab2cc73e399834365a15f6139dd92aa36aaa00"},"dob":{"date":"1952-08-02T01:08:28.983Z","age":70},"registered":{"date":"2011-09-03T12:19:05.957Z","age":11},"phone":"0848-9894198","cell":"0174-6265796","id":{"name":"","value":null},"picture":{"large":"https://randomuser.me/api/portraits/women/34.jpg","medium":"https://randomuser.me/api/portraits/med/women/34.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/women/34.jpg"},"nat":"DE"},{"gender":"female","name":{"title":"Mrs","first":"Eugenia","last":"Garrido"},"location":{"street":{"number":1437,"name":"Calle de Toledo"},"city":"Oviedo","state":"Cantabria","country":"Spain","postcode":18215,"coordinates":{"latitude":"48.8429","longitude":"-121.0995"},"timezone":{"offset":"-3:00","description":"Brazil, Buenos Aires, Georgetown"}},"email":"eugenia.garrido@example.com","login":{"uuid":"b4fe661c-cf7b-4486-be1f-b43ad7f74376","username":"bluemouse813","password":"bull","salt":"aaIgpmGc","md5":"50cc3b5a4d9f3ec1db2790134f698be0","sha1":"9ba77a3e15524dabadf32c927bf3b5c11672fcfd","sha256":"5991eb2a9d98c8a56fc12450d47fa5a73615798564a95000fe7915118b8a8165"},"dob":{"date":"1988-11-12T06:44:27.500Z","age":34},"registered":{"date":"2018-04-11T21:37:55.282Z","age":4},"phone":"932-662-427","cell":"600-834-291","id":{"name":"DNI","value":"78108438-L"},"picture":{"large":"https://randomuser.me/api/portraits/women/56.jpg","medium":"https://randomuser.me/api/portraits/med/women/56.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/women/56.jpg"},"nat":"ES"},{"gender":"female","name":{"title":"Mrs","first":"Brittany","last":"Burke"},"location":{"street":{"number":9111,"name":"Church Road"},"city":"Stirling","state":"Durham","country":"United Kingdom","postcode":"NA8H 8LE","coordinates":{"latitude":"3.7120","longitude":"113.2596"},"timezone":{"offset":"+7:00","description":"Bangkok, Hanoi, Jakarta"}},"email":"brittany.burke@example.com","login":{"uuid":"c56f35d6-27a3-48fb-9bee-ed170db40a14","username":"happyzebra542","password":"priest","salt":"LhlZ5IxN","md5":"d0cb9498b9a1577077dcba6fdf923027","sha1":"9b72e88f4abc08b2911f8e5e0e46f2d522668813","sha256":"f913acaba80edd699396a2e6b439ac207363bccc0077b09e9c70bf19d315f9b6"},"dob":{"date":"1996-04-11T11:19:52.296Z","age":26},"registered":{"date":"2018-03-30T13:19:51.216Z","age":4},"phone":"019467 14770","cell":"0778-990-875","id":{"name":"NINO","value":"SL 16 32 40 C"},"picture":{"large":"https://randomuser.me/api/portraits/women/34.jpg","medium":"https://randomuser.me/api/portraits/med/women/34.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/women/34.jpg"},"nat":"GB"},{"gender":"male","name":{"title":"Mr","first":"Esat","last":"Poçan"},"location":{"street":{"number":7698,"name":"Atatürk Sk"},"city":"Kilis","state":"Kırşehir","country":"Turkey","postcode":34728,"coordinates":{"latitude":"-29.5711","longitude":"-161.2758"},"timezone":{"offset":"-11:00","description":"Midway Island, Samoa"}},"email":"esat.pocan@example.com","login":{"uuid":"91b5c8c4-5270-4d57-a82a-451b56dfabc8","username":"greendog839","password":"silverad","salt":"6N8fp9L2","md5":"af32ba3dff3075820cc1ed4ffc9e98e4","sha1":"02da84d2d147903122b7bbfe6d568e52c09e6ce5","sha256":"9e87b2479d57c93fac9f5374c5fff2237c7aa6a2406f2d0f4ac80a83b2425d67"},"dob":{"date":"1957-10-27T14:41:02.151Z","age":65},"registered":{"date":"2004-04-20T18:09:22.618Z","age":18},"phone":"(531)-908-3644","cell":"(534)-831-5599","id":{"name":"","value":null},"picture":{"large":"https://randomuser.me/api/portraits/men/82.jpg","medium":"https://randomuser.me/api/portraits/med/men/82.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/men/82.jpg"},"nat":"TR"},{"gender":"male","name":{"title":"Mr","first":"Willie","last":"Silva"},"location":{"street":{"number":389,"name":"E Sandy Lake Rd"},"city":"Utica","state":"Vermont","country":"United States","postcode":48997,"coordinates":{"latitude":"24.8696","longitude":"-68.1151"},"timezone":{"offset":"-7:00","description":"Mountain Time (US & Canada)"}},"email":"willie.silva@example.com","login":{"uuid":"3373c84f-67f5-4182-a3fd-33142b5745d7","username":"silverlion135","password":"absolutely","salt":"PdoceatU","md5":"a167523746562264899986c98829ccd2","sha1":"a8d9c0a6b5db441eb35bdf9478106dce9000c2d6","sha256":"ee607caa932d10aa029e1fb0dd87c83378ab0e3c66ed3d4daf01f1f42b3ea363"},"dob":{"date":"1951-06-18T11:08:30.817Z","age":71},"registered":{"date":"2017-08-11T08:27:24.602Z","age":5},"phone":"(260)-333-7606","cell":"(693)-716-3621","id":{"name":"SSN","value":"499-91-2043"},"picture":{"large":"https://randomuser.me/api/portraits/men/41.jpg","medium":"https://randomuser.me/api/portraits/med/men/41.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/men/41.jpg"},"nat":"US"},{"gender":"male","name":{"title":"Mr","first":"میلاد","last":"موسوی"},"location":{"street":{"number":4386,"name":"شهید کامبیز خشی"},"city":"شیراز","state":"مازندران","country":"Iran","postcode":92813,"coordinates":{"latitude":"83.3951","longitude":"178.4407"},"timezone":{"offset":"+2:00","description":"Kaliningrad, South Africa"}},"email":"myld.mwswy@example.com","login":{"uuid":"752cf5ae-b6a4-4b55-83d7-dfec495a227a","username":"goldencat351","password":"kids","salt":"vLe4flPV","md5":"679db85c22a3050819ab623e4ddea77c","sha1":"867a004dbb6687178b6a62b7fa6059d9e72365b6","sha256":"dd0e6e39f798ea7183f7b4653cdec3c7853b660d43d1c4a6babfa572c10f67af"},"dob":{"date":"1990-01-27T02:22:25.130Z","age":32},"registered":{"date":"2019-05-30T14:28:15.886Z","age":3},"phone":"041-34220289","cell":"0988-863-2896","id":{"name":"","value":null},"picture":{"large":"https://randomuser.me/api/portraits/men/97.jpg","medium":"https://randomuser.me/api/portraits/med/men/97.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/men/97.jpg"},"nat":"IR"},{"gender":"male","name":{"title":"Mr","first":"Sammy","last":"Roberts"},"location":{"street":{"number":2930,"name":"Manor Road"},"city":"Bangor","state":"Lincolnshire","country":"United Kingdom","postcode":"FN7K 8NQ","coordinates":{"latitude":"-89.1065","longitude":"14.5865"},"timezone":{"offset":"-2:00","description":"Mid-Atlantic"}},"email":"sammy.roberts@example.com","login":{"uuid":"f6c13136-28c3-4fb6-929e-75212cb0f066","username":"sadkoala898","password":"choochoo","salt":"psLEs23M","md5":"c71d3eb2321e824116a1d81789cde54e","sha1":"a067c60fc5a70c9de75ab533b789193226733c25","sha256":"488ecd88d621bee4c9176d587a924bdd1fed96ec7cf4b8ee4d531fa0619aa7fc"},"dob":{"date":"1980-05-30T18:35:48.711Z","age":42},"registered":{"date":"2007-07-21T01:16:24.851Z","age":15},"phone":"021 5693 1463","cell":"0780-066-863","id":{"name":"NINO","value":"HB 59 39 87 Z"},"picture":{"large":"https://randomuser.me/api/portraits/men/12.jpg","medium":"https://randomuser.me/api/portraits/med/men/12.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/men/12.jpg"},"nat":"GB"},{"gender":"male","name":{"title":"Mr","first":"Volkan","last":"Tekelioğlu"},"location":{"street":{"number":9827,"name":"Vatan Cd"},"city":"Kastamonu","state":"Erzurum","country":"Turkey","postcode":26764,"coordinates":{"latitude":"-69.6885","longitude":"-169.0615"},"timezone":{"offset":"-3:30","description":"Newfoundland"}},"email":"volkan.tekelioglu@example.com","login":{"uuid":"44fd1cfc-3584-4a58-9396-779ca7a52400","username":"smallgoose868","password":"friendly","salt":"xgQUfNLD","md5":"89eda3b58ab60392590b6350c9522471","sha1":"6577f69d57ab1d802de20eedc6bc1678431bf9c1","sha256":"3c96644d3d42e6708d12eed0e53ab26aefb1d21fa3cf047f41eb312fe32431cc"},"dob":{"date":"1979-06-11T05:13:53.272Z","age":43},"registered":{"date":"2014-11-29T12:42:17.223Z","age":8},"phone":"(647)-807-4094","cell":"(020)-541-7345","id":{"name":"","value":null},"picture":{"large":"https://randomuser.me/api/portraits/men/1.jpg","medium":"https://randomuser.me/api/portraits/med/men/1.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/men/1.jpg"},"nat":"TR"},{"gender":"female","name":{"title":"Miss","first":"Josefa","last":"Vidal"},"location":{"street":{"number":5761,"name":"Calle de Toledo"},"city":"Pontevedra","state":"Cantabria","country":"Spain","postcode":68705,"coordinates":{"latitude":"53.1076","longitude":"-6.5700"},"timezone":{"offset":"-12:00","description":"Eniwetok, Kwajalein"}},"email":"josefa.vidal@example.com","login":{"uuid":"e4664d16-9648-47f1-a4e9-bd39c0d3285d","username":"lazysnake904","password":"beech","salt":"ljJb4Hh0","md5":"1aaa3572d28cb0cc00cfb374571a8379","sha1":"e68f302ba8ae0054755660c51553c478112800e7","sha256":"08798b04e03db55b2375ad7318ba75b87e5761f63882910a215f14bad1fc87e5"},"dob":{"date":"1971-11-14T06:02:10.874Z","age":51},"registered":{"date":"2008-07-23T19:00:34.835Z","age":14},"phone":"987-860-491","cell":"631-759-087","id":{"name":"DNI","value":"71287230-Z"},"picture":{"large":"https://randomuser.me/api/portraits/women/26.jpg","medium":"https://randomuser.me/api/portraits/med/women/26.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/women/26.jpg"},"nat":"ES"},{"gender":"female","name":{"title":"Miss","first":"Isabella","last":"Ouellet"},"location":{"street":{"number":1436,"name":"College Ave"},"city":"Shelbourne","state":"Ontario","country":"Canada","postcode":"A8Y 1Y7","coordinates":{"latitude":"-3.6440","longitude":"139.3477"},"timezone":{"offset":"+6:00","description":"Almaty, Dhaka, Colombo"}},"email":"isabella.ouellet@example.com","login":{"uuid":"edf73fd6-94a8-4bf9-9b55-952a93100814","username":"redrabbit385","password":"corwin","salt":"RoVGq8P2","md5":"39ab33457acbb1c39e7f07cf17e2ae0d","sha1":"74e4cf9138d328cc516787ac81833f5482e36695","sha256":"5b309160fba6c2b262a6ecb87a80181fb5292a648d80f1b89399063e2d12a432"},"dob":{"date":"1996-08-13T07:45:53.974Z","age":26},"registered":{"date":"2005-01-07T11:47:11.784Z","age":17},"phone":"119-892-9728","cell":"810-481-2756","id":{"name":"","value":null},"picture":{"large":"https://randomuser.me/api/portraits/women/38.jpg","medium":"https://randomuser.me/api/portraits/med/women/38.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/women/38.jpg"},"nat":"CA"},{"gender":"male","name":{"title":"Mr","first":"David","last":"Graves"},"location":{"street":{"number":5340,"name":"W Pecan St"},"city":"Mackay","state":"Tasmania","country":"Australia","postcode":263,"coordinates":{"latitude":"-52.5655","longitude":"7.6530"},"timezone":{"offset":"+1:00","description":"Brussels, Copenhagen, Madrid, Paris"}},"email":"david.graves@example.com","login":{"uuid":"023acde9-64a9-4463-800c-674f1ce10d65","username":"organicfish870","password":"prince","salt":"89A0JL6i","md5":"168e1b2674790a92a33b6c553636b07a","sha1":"be741ec4b84ef4000b7f3b43a7590378a1f4e434","sha256":"22107637a189566a9ec5f91438d8042c5c92628cdf12e13b85c3332509d48b70"},"dob":{"date":"1994-06-28T07:04:42.020Z","age":28},"registered":{"date":"2018-07-21T08:28:41.578Z","age":4},"phone":"04-4115-2306","cell":"0404-688-837","id":{"name":"TFN","value":"554029336"},"picture":{"large":"https://randomuser.me/api/portraits/men/8.jpg","medium":"https://randomuser.me/api/portraits/med/men/8.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/men/8.jpg"},"nat":"AU"},{"gender":"female","name":{"title":"Miss","first":"Lara","last":"Byrkjeland"},"location":{"street":{"number":7067,"name":"Professor Aschehougs plass"},"city":"Teigebyen","state":"Aust-Agder","country":"Norway","postcode":"9009","coordinates":{"latitude":"58.9262","longitude":"-18.3870"},"timezone":{"offset":"+3:30","description":"Tehran"}},"email":"lara.byrkjeland@example.com","login":{"uuid":"8a218ce2-d5c9-412d-a86a-b6f7fe5ae532","username":"organicfish753","password":"tanker","salt":"3SXHBzLS","md5":"32a391ac1195c873582952da8c7b6979","sha1":"2d1de1204503fb2ad9633fa97cab622c0001c556","sha256":"be2ad3d76b9a465875e7d5855b2aaec5ea5e7484c8b55f09783802f1a1bd47a4"},"dob":{"date":"1984-12-09T08:34:55.543Z","age":38},"registered":{"date":"2017-11-13T11:12:36.185Z","age":5},"phone":"33914490","cell":"95576480","id":{"name":"FN","value":"09128437611"},"picture":{"large":"https://randomuser.me/api/portraits/women/26.jpg","medium":"https://randomuser.me/api/portraits/med/women/26.jpg","thumbnail":"https://randomuser.me/api/portraits/thumb/women/26.jpg"},"nat":"NO"}],"info":{"seed":"0cd0c0f1f36060a4","results":20,"page":1,"version":"1.3"}}
"""

def close_enough(x, y, tolerance=0.001):
    print(abs(x - y))
    return abs(x - y) < tolerance

def test_percentage_female_v_male():
    users = UserListSchema().loads(test_small_json_blob)['results']

    assert close_enough(percentage_female_v_male(users), 0.333)


def test_percentage_first_name_start_a_n():
    users = UserListSchema().loads(test_small_json_blob)['results']

    assert close_enough(percentage_first_name_start_a_n(users), 0.666)



def test_percentage_last_name_start_a_n():
    users = UserListSchema().loads(test_small_json_blob)['results']

    assert close_enough(percentage_last_name_start_a_n(users), 0)


def test_percentage_people_in_states():
    users = UserListSchema().loads(test_small_json_blob)['results']
    result = percentage_people_in_states(users)
    assert len(result) == 3

    for state, p in result:
        assert close_enough(p, 0.333)



def test_percentage_females_in_states():
    users = UserListSchema().loads(test_small_json_blob)['results']
    result = percentage_females_in_states(users)
    assert len(result) == 1

    for state, p in result:
        if state == 'سمنان':
            assert close_enough(p, 1)
        else:
            assert close_enough(p, 0)


def test_percentage_males_in_states():
    users = UserListSchema().loads(test_small_json_blob)['results']
    result = percentage_males_in_states(users)
    assert len(result) == 2

    for state, p in result:
        assert close_enough(p, 0.5)